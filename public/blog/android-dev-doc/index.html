<!doctype html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<title>Android å¼€å‘æ‰‹å†Œ - Xiaodan.C</title>
<meta name="description" content="Android dev">
<meta name="viewport" content="width=device-width, initial-scale=1">



  <meta name="generator" content="Hugo 0.57.2" />
  <meta itemprop="name" content="Android å¼€å‘æ‰‹å†Œ">
<meta itemprop="description" content="Android dev">


<meta itemprop="datePublished" content="2019-08-20T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2019-08-20T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1074">



<meta itemprop="keywords" content="" />

  <meta property="og:title" content="Android å¼€å‘æ‰‹å†Œ" />
<meta property="og:description" content="Android dev" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://congxiaodan.cn/blog/android-dev-doc/" />
<meta property="article:published_time" content="2019-08-20T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-08-20T00:00:00+00:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Android å¼€å‘æ‰‹å†Œ"/>
<meta name="twitter:description" content="Android dev"/>
<meta name="twitter:site" content="@Cid_isCoder"/>

  

  <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css">
  
    
      <link rel="stylesheet" href="/css/normalize.css">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800,900|Source+Sans+Pro:400,700">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.1.0/css/flag-icon.min.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css">
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css" integrity="sha384-i1LQnF23gykqWXg6jxC2ZbCbUMxyw5gLZY6UiUS98LYV5unm8GWmfkIS6jqJfb4E" crossorigin="anonymous">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.3.5/jquery.fancybox.min.css" />
      
      
      <link rel="stylesheet" href="/css/main.min.e25bd28619877b6db95b4bb0d84aada96f31ca55d4e0ac23b576470df37a8f85.css" integrity="sha256-4lvShhmHe225W0uw2EqtqW8xylXU4KwjtXZHDfN6j4U=">
      <link rel="stylesheet" href="/css/add-on.css">
    
  
  
  
  
  
</head>

  <body>
    
<header id="site-header">
  <nav id="site-nav">
    <h1 class="nav-title">
      <a href="/">
        
          
            Blog
          
        
      </a>
    </h1>
    <menu id="site-nav-menu" class="flyout-menu">
      
        <a href="/" class="link"><i class="fas fa-home">&nbsp;</i>Home</a>
      
        <a href="/about/" class="link"><i class="far fa-id-card">&nbsp;</i>About</a>
      
        <a href="/blog/" class="link"><i class="far fa-newspaper">&nbsp;</i>Blog</a>
      
        <a href="/categories/" class="link"><i class="fas fa-sitemap">&nbsp;</i>Categories</a>
      
        <a href="/contact/" class="link"><i class="far fa-envelope">&nbsp;</i>Contact</a>
      
      
      

    </menu>
    

    
    
    <a href="#site-nav" class="nav-toggle"><i class="fas fa-bars fa-2x"></i></a>
  </nav>
  
  
</header>

    <div id="wrapper">
      <section id="site-intro">
  <a href="/"><img src="/img/main/logo.jpg" class="circle" width="" alt="Hugo Future Imperfect Slim" /></a>
  <header>
    <h1>Xiaodan.Cong</h1>
  </header>
  <main>
    <p>ğŸ¤”Xiaodn.Â©ï¸â„¢ï¸ ğŸ¡â›…ï¸</p>
  </main>
  
    <footer>
      <ul class="socnet-icons">
        

        <li><a href="//github.com/C-isCoder" target="_blank" rel="noopener" title="GitHub" class="fab fa-github"></a></li>
















<li><a href="//facebook.com/cong.xiaodan" target="_blank" rel="noopener" title="Facebook" class="fab fa-facebook"></a></li>






<li><a href="weixin://contacts/profile/Return_Null" target="_blank" rel="noopener" title="WeChat" class="fab fa-weixin"></a></li>
<li><a href="//wpa.qq.com/msgrd?v=3&amp;uin=1502219221&amp;site=qq&amp;menu=yes" target="_blank" rel="noopener" title="QQ" class="fab fa-qq"></a></li>
<li><a href="//instagram.com/xiaodan.cong" target="_blank" rel="noopener" title="Instagram" class="fab fa-instagram"></a></li>

<li><a href="//twitter.com/Cid_isCoder" target="_blank" rel="noopener" title="Twitter" class="fab fa-twitter"></a></li>










<li><a href="mailto:Xiaodan.Cong@qq.com" target="_blank" title="Email" class="far fa-envelope"></a></li>

      </ul>
    </footer>
  
</section>

      <main id="site-main">
        <article class="post">
  <header>
  <div class="title">
    
        <h2><a href="/blog/android-dev-doc/">Android å¼€å‘æ‰‹å†Œ</a></h2>
    
    
        <p>Android dev</p>
    
</div>
  <div class="meta">
    <time class="published" datetime="2019-08-20 00:00:00 &#43;0000 UTC">
      August 20, 2019
    </time>
    <span class="author">Xiaodan.C</span>
    
        <p>6 minute read</p>
    
  </div>
</header>

  <section id="socnet-share">
    




  
    
    <a href="//twitter.com/share?text=Android%20%e5%bc%80%e5%8f%91%e6%89%8b%e5%86%8c&amp;url=https%3a%2f%2fcongxiaodan.cn%2fblog%2fandroid-dev-doc%2f" target="_blank" rel="noopener" class="share-btn twitter">
        <i class="fab fa-twitter"></i><p>&nbsp;Twitter</p>
      </a>
  

  
      <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fcongxiaodan.cn%2fblog%2fandroid-dev-doc%2f" target="_blank" rel="noopener" class="share-btn facebook">
        <i class="fab fa-facebook"></i><p>&nbsp;Facebook</p>
        </a>
  

  
        <a href="mailto:?subject=Check out this post by %7b%20%20%20%20%20%20%20%20map%5b%5d%7d&amp;body=https%3a%2f%2fcongxiaodan.cn%2fblog%2fandroid-dev-doc%2f" target="_blank" class="share-btn email" data-proofer-ignore>
          <i class="fas fa-envelope"></i><p>&nbsp;Email</p>
        </a>
  


  </section>
  
<a href="/blog/android-dev-doc/" class="image featured">
  <img src="/img/2019/08/pic01.jpg" alt="Pic 1">
</a>


  <div class="content">
    

<h2 id="å·¥ç¨‹">å·¥ç¨‹</h2>

<h3 id="ç»“æ„">ç»“æ„</h3>

<ul>
<li>æ•´ä½“é¡¹ç›®0ä¾èµ– model ï¼Œå•ä¸€æ¨¡å—å·¥ç¨‹</li>
</ul>

<p><img src="/img/2019/07/1.png" alt="" />
<img src="/img/2019/07/2.png" alt="" /></p>

<ol>
<li>åŒ…åˆ’åˆ†ï¼šæŒ‰ç…§é¡¹ç›®åŠŸèƒ½æ¨¡å—åˆ’åˆ†ï¼Œæ¨¡å—ä¸‹æ ¹æ®åŠŸèƒ½çš„å¤šå°‘ï¼Œè€ƒè™‘æ˜¯å¦ç»†åˆ†åŒ…ã€‚</li>
<li>é…ç½®æ–‡ä»¶ï¼Œç”±ä¹‹å‰çš„å•ä¸€ Gradle æ–‡ä»¶ï¼Œæ‹†åˆ†ä¸º <strong>thrid.gradle</strong>ï¼ˆç¬¬ä¸‰æ–¹ä¾èµ–ï¼‰ã€<strong>thrid-key.gradle</strong>ï¼ˆç¬¬ä¸‰æ–¹ä¾èµ–çš„keyï¼‰ã€<strong>version.gradle</strong>ï¼ˆé¡¹ç›®ç®¡ç†ï¼‰ã€‚<strong>Jenkinsfile</strong>ï¼ˆCIæµç¨‹æ–‡ä»¶ï¼‰</li>
</ol>

<h3 id="æ¶æ„ç»„ç»‡-mvp">æ¶æ„ç»„ç»‡ï¼ˆMVPï¼‰</h3>

<ul>
<li>æ¯ä¸ªé¡µé¢ç”±3ä¸ªæ–‡ä»¶ xxxActivity\Fragmentï¼ŒxxxContractï¼ŒxxxPresenter</li>
</ul>

<p><img src="/img/2019/07/3.png" alt="" /></p>

<h2 id="è§„èŒƒ">è§„èŒƒ</h2>

<h3 id="åŒ…å‘½å">åŒ…å‘½å</h3>

<ul>
<li>åŠŸèƒ½åï¼Œå¯¹åº”çš„::è‹±æ–‡å•è¯ï¼Œå…¨å°å†™::</li>
<li>egï¼š<code>com.baichang.consumer.active</code></li>
</ul>

<h3 id="activity-fragment-service-ç±»å">Activityã€Fragmentã€Serviceã€ç±»å</h3>

<ul>
<li>åŠŸèƒ½åï¼Œå¯¹åº”çš„::è‹±æ–‡å•è¯ï¼Œé¦–å­—æ¯å¤§å†™+Activity\Fragment\Service::</li>
<li>egï¼š<code>MessageActivityã€MessageFragmentã€MessageService</code></li>
</ul>

<h3 id="xmlèµ„æºæ–‡ä»¶">XMLèµ„æºæ–‡ä»¶</h3>

<h4 id="é¢œè‰²">é¢œè‰²</h4>

<ul>
<li>::ç±»å‹_åç§°+è‰²å€¼åä¸¤ä½(å¤§å†™)::</li>
<li>egï¼š<code>font_color_blackBD</code>  -&gt; <code>#FFBDBDBD</code></li>
</ul>

<h4 id="æ–‡å­—">æ–‡å­—</h4>

<ol>
<li>æ™®é€šæç¤ºç±»å‹çš„æ–‡å­—æè¿°ï¼š::tips_è‹±æ–‡æè¿°::</li>
</ol>

<p>egï¼š<code>tips_please_input_name</code> -&gt; <code>è¯·è¾“å…¥æ‚¨çš„åå­—</code></p>

<pre><code class="language-xml">&lt;string name=&quot;tips_please_input_name&quot;&gt;è¯·è¾“å…¥æ‚¨çš„åå­—&lt;/string&gt;
</code></pre>

<ol>
<li>æˆåŠŸ/å¤±è´¥ç±»å‹çš„æ–‡å­—æè¿°ï¼š ::tips_è‹±æ–‡æè¿°_success\failed::</li>
</ol>

<p>egï¼š<code>tips_submit_success</code> -&gt; <code>æäº¤æˆåŠŸ</code></p>

<pre><code class="language-xml">&lt;string name=&quot;tips_submit_success&quot;&gt;æäº¤æˆåŠŸ&lt;/string&gt;
&lt;string name=&quot;tips_submit_failed&quot;&gt;æäº¤å¤±è´¥&lt;/string&gt;
</code></pre>

<ol>
<li>å¸¦æœ‰æ ¼å¼åŒ–ç±»å‹çš„æ–‡å­—æè¿°ï¼š::format_è‹±æ–‡æè¿°::</li>
</ol>

<p>egï¼š<code>format_card_invalid</code> -&gt; <code>å¤±æ•ˆæ—¥æœŸï¼š%s</code></p>

<pre><code class="language-xml">&lt;string name=&quot;format_card_invalid&quot;&gt;å¤±æ•ˆæ—¥æœŸï¼š%s&lt;/string&gt;
</code></pre>

<ol>
<li>æ™®é€šç±»å‹çš„æ–‡å­—æè¿°ï¼š::è‹±æ–‡å•è¯_è‹±æ–‡å•è¯::</li>
</ol>

<p>egï¼š<code>collar_center</code> -&gt; <code>é¢†åˆ¸ä¸­å¿ƒ</code></p>

<pre><code class="language-xml">&lt;string name=&quot;collar_center&quot;&gt;é¢†åˆ¸ä¸­å¿ƒ&lt;/string&gt;
</code></pre>

<h4 id="androidmainfest-xml">AndroidMainfest.xml</h4>

<ul>
<li><p>æ‰€æœ‰çš„ Activityã€Service å¿…é¡»æ³¨é‡Šä¸­æ–‡æ¨¡å—å</p>

<pre><code class="language-xml">/&lt;!-- æ„è§åé¦ˆ --&gt;/
&lt;activity android:name=&quot;.mine.feedback.FeedbackActivity&quot;/&gt;
/&lt;!-- æœåŠ¡åè®® --&gt;/
&lt;activity android:name=&quot;.login.ServiceProtocolActivity&quot;/&gt;
/&lt;!-- æ´»åŠ¨ä¸­å¿ƒ --&gt;/
&lt;activity android:name=&quot;.active.ActiveActivity&quot;/&gt;
/&lt;!-- çœå¸‚åŒºæ•°æ®æœåŠ¡ --&gt;/
&lt;service
android:name=&quot;.service.ChinaTownIntentService&quot;
android:exported=&quot;false&quot;&gt;
</code></pre></li>
</ul>

<h4 id="å¸ƒå±€æ–‡ä»¶">å¸ƒå±€æ–‡ä»¶</h4>

<ul>
<li>Activity\Fragment å¸ƒå±€æ–‡ä»¶ ::Activity\Fragment_æ¨¡å—\åŠŸèƒ½è‹±æ–‡åå…¨å°å†™::</li>
</ul>

<p>egï¼š<code>activity\fragment_message</code></p>

<ul>
<li>ListItemå¸ƒå±€æ–‡ä»¶::item_æ¨¡å—\åŠŸèƒ½è‹±æ–‡åå…¨å°å†™::
<br /></li>
</ul>

<p>egï¼š<code>item_message</code></p>

<ul>
<li>å¼•å…¥å¸ƒå±€æ–‡ä»¶::include_æ¨¡å—\åŠŸèƒ½è‹±æ–‡åå…¨å°å†™::
<br /></li>
</ul>

<p>egï¼š<code>include_message_header</code></p>

<ul>
<li>Dialogå¸ƒå±€æ–‡ä»¶::dialog_æ¨¡å—\åŠŸèƒ½è‹±æ–‡åå…¨å°å†™::
<br /></li>
</ul>

<p>egï¼š<code>dialog_message</code></p>

<ul>
<li>PopupWindowå¸ƒå±€æ–‡ä»¶::pop_æ¨¡å—\åŠŸèƒ½è‹±æ–‡åå…¨å°å†™::
<br /></li>
</ul>

<p>egï¼š<code>pop_message</code></p>

<h4 id="drawableèµ„æºæ–‡ä»¶">Drawableèµ„æºæ–‡ä»¶</h4>

<blockquote>
<p><em><strong>é¢œè‰²ã€åœ†è§’åªåœ¨æœ‰å¤šä¸ªç›¸åŒåŠŸèƒ½ï¼Œä¸åŒæ ·å¼çš„æƒ…å†µä¸‹ä½¿ç”¨</strong></em></p>
</blockquote>

<ul>
<li>æŒ‰é’®ç±»å‹çš„ drawable ::button_åŠŸèƒ½\æ¨¡å—è‹±æ–‡åå…¨å°å†™_é¢œè‰²_åœ†è§’::</li>
</ul>

<p>egï¼š<code>button_back_white_10</code></p>

<ul>
<li>Shapeç±»å‹çš„ drawable ::shape_åŠŸèƒ½\æ¨¡å—è‹±æ–‡åå…¨å°å†™_é¢œè‰²_åœ†è§’::
<br /></li>
</ul>

<p>egï¼š<code>shape_address</code></p>

<ul>
<li>Selectorç±»å‹çš„ drawable ::selector_åŠŸèƒ½\æ¨¡å—è‹±æ–‡åå…¨å°å†™_é¢œè‰²_åœ†è§’::
<br /></li>
</ul>

<p>egï¼š<code>selector_address</code></p>

<ul>
<li>å…¶ä»–çš„ç±»å‹ä»¥æ§ä»¶åå­—ä¸ºå‰ç¼€ï¼Œä¾‹å¦‚ <strong>checkbox</strong>ã€<strong>radio</strong></li>
</ul>

<p>egï¼š<code>radio_sex_man checkbox_eye</code></p>

<ul>
<li>é¡¹ç›®é¦–é¡µä¸‹è¾¹4ä¸ªTabæŒ‰é’®å•ç‹¬å‘½åä¸º::tab_æ¨¡å—è‹±æ–‡åå°å†™::</li>
</ul>

<p>egï¼š<code>tab_home</code></p>

<h3 id="ä»£ç ">ä»£ç </h3>

<h4 id="å¸¸é‡-å˜é‡å‘½å">å¸¸é‡ã€å˜é‡å‘½å</h4>

<blockquote>
<p><em><strong>ä¼˜å…ˆ val å¸¸é‡å‘½åï¼Œé™¤éè¦æ±‚å¯å˜ï¼Œæ‰ä¼šç”¨ var</strong></em></p>
</blockquote>

<ol>
<li>å…¨å±€å˜é‡åï¼Œå…³é”®å­—::<strong>var</strong>::ï¼Œéµå¾ª::é©¼å³°å‘½å::è§„åˆ™ï¼Œå°½é‡ç®€æ´æ˜äº†ï¼Œä¸è¶…è¿‡2ä¸ªå•è¯ã€‚</li>
</ol>

<p>egï¼š<code>private var nowPage = 1</code></p>

<ol>
<li>å…¨å±€å¸¸é‡åï¼Œå…³é”®å­—::<strong>val</strong>::ï¼Œéµå¾ª::é©¼å³°å‘½å::è§„åˆ™ï¼Œå°½é‡ç®€æ´æ˜äº†ï¼Œä¸è¶…è¿‡2ä¸ªå•è¯ã€‚</li>
</ol>

<p>egï¼š<code>private val preferences = view.getPreferences()</code></p>

<ol>
<li>å±€éƒ¨å˜é‡ï¼Œå°½å¯èƒ½ä½¿ç”¨::<strong>val</strong>::ï¼Œéµå¾ª::é©¼å³°å‘½å::è§„åˆ™ï¼Œå°½é‡ç®€æ´æ˜äº†ã€‚ä¸è¶…è¿‡2ä¸ªå•è¯ã€‚</li>
</ol>

<p>egï¼š<code>val phone = view.getNumber()</code></p>

<ol>
<li><p>é™æ€å…¨å±€å¸¸é‡ï¼Œkotlin ä¸­ï¼Œéœ€è¦åœ¨åŠç”Ÿå¯¹è±¡ä¸­å£°æ˜é™æ€å…¨å±€å¸¸é‡ï¼Œ::å¤§å†™è‹±æ–‡å­—æ¯_é“¾æ¥::</p>

<pre><code class="language-java">companion object {
const val REFRESH_CODE = 10010
}
</code></pre></li>
</ol>

<p>è®¿é—®ï¼š<code>ç±»å.REFRESH_CODE</code></p>

<ol>
<li>Boolç±»å‹å£°æ˜ï¼Œå…³é”®å­—::isã€hasã€can+è‹±æ–‡::ï¼Œéµå¾ª::é©¼å³°å‘½å::è§„åˆ™ï¼Œå°½é‡ç®€æ´æ˜äº†ï¼Œä¸è¶…è¿‡2ä¸ªå•è¯ã€‚
<br /></li>
</ol>

<p>egï¼š<code>var isRefresh = trueã€var hasCallPermission = trueã€var canClose = false</code></p>

<h4 id="æ§ä»¶çš„å‘½å">æ§ä»¶çš„å‘½å</h4>

<blockquote>
<p><em><strong>åŒä¸€ä¸ªå¸ƒå±€æ–‡ä»¶ä¸­ï¼Œåç§°å”¯ä¸€</strong></em></p>
</blockquote>

<ol>
<li>å¸¸ç”¨æ§ä»¶ï¼Œéµå¾ª::é©¼å³°å‘½åï¼Œç®€ç§°+åŠŸèƒ½::è§„åˆ™ï¼Œå°½é‡ç®€æ´ï¼Œä¸è¶…è¿‡2ä¸ªå•è¯ã€‚ï¼ˆå¯¹äºåˆ·æ–°æ§ä»¶ç»Ÿä¸€å‘½åä¸º<code>progress</code>ï¼‰</li>
</ol>

<p>egï¼š<code>tvName,ivAvatar,llPhone,rlLayout,rvList,cbSex,rbMan,btnSubmit</code></p>

<ol>
<li>ç‰¹æ®Šå‘½åï¼Œåœ¨ RelativeLayout å¸ƒå±€ä¸­ï¼Œä»…ä»…ä½œä¸ºå¸ƒå±€çš„ç›¸å¯¹ä½ç½®æè¿°çš„å‘½åï¼ˆä¸å‚ä¸ä»£ç çš„é€»è¾‘ï¼‰ï¼Œé‡‡ç”¨::_å•è¯::çš„æ–¹å¼ï¼Œé•¿åº¦ä¸º1ä¸ªè‹±æ–‡å•è¯ã€‚</li>
</ol>

<p>egï¼š<code>_title,_card</code></p>

<h4 id="ç±»-æ–¹æ³•å‘½å">ç±»ã€æ–¹æ³•å‘½å</h4>

<ul>
<li><p>éµå¾ª::é©¼å³°å‘½åï¼ŒåŠ¨è¯+åå­—\å½¢å®¹è¯::è§„åˆ™ï¼Œç±»å::é¦–å­—æ¯å¤§å†™::ï¼Œå°½é‡ç®€æ´çš„è¡¨è¾¾å‡ºï¼Œæ–¹æ³•\ç±»çš„åŠŸèƒ½\ä½œç”¨ï¼Œä¸è¶…è¿‡3ä¸ªå•å­ã€‚</p>

<pre><code class="language-coffee">fun showMessage(msg: String)
fun showMessage(msgId: Int)
fun showProgress()
fun hideProgress()
fun setIngots(number: String)
fun setAnnouncement(list: List&lt;String&gt;)
fun getPreferences(): SharedPreferences
fun startProgress(data: ActiveData)
fun setEmptyStatus(isShow: Boolean)
</code></pre></li>

<li><p>æ–¹æ³•å‚æ•°éµå¾ª::é©¼å³°å‘½åï¼ŒåŠ¨è¯+åå­—\å½¢å®¹è¯::è§„åˆ™ï¼Œå°½å¯èƒ½ç®€æ´ï¼Œä¸è¶…è¿‡2ä¸ªå•è¯ã€‚</p></li>

<li><p>æ–¹æ³•ã€è·³è½¬é¿å…å¯¹è±¡çš„ä¼ é€’ã€‚</p></li>

<li><p>æ¥å£ Api å‘½åéµå¾ª::é©¼å³°å‘½åï¼ŒåŠ¨è¯+åå­—\å½¢å®¹è¯::è§„åˆ™ï¼Œæ¯ä¸ªæ¥å£ä¸Šæ–¹å¿…é¡»æ³¨é‡Šæ¥å£ä¸­æ–‡åç§°ï¼Œå°½é‡ç®€æ´ã€‚</p>

<pre><code class="language-java">// æ£€æŸ¥æ›´æ–°
@POST(&quot;app/checkEdition&quot;)
fun upgrade(@Body map: Map&lt;String, String&gt;): Observable&lt;UpgradeData&gt;

// è·å–éªŒè¯ç 
@POST(&quot;app/sendCode&quot;)
fun getCode(@Body map: Map&lt;String, String&gt;): Observable&lt;Boolean&gt;

// éªŒè¯ç æ ¡éªŒ
@POST(&quot;app/checkPerfect&quot;)
fun checkCode(@Body map: Map&lt;String, String&gt;): Observable&lt;Int&gt;

// ç™»å½•
@POST(&quot;app/loginDirect&quot;)
fun login(@Body map: Map&lt;String, String&gt;): Observable&lt;LoginData&gt;
</code></pre></li>
</ul>

<h4 id="ä»£ç ä¹¦å†™">ä»£ç ä¹¦å†™</h4>

<ol>
<li>æ–¹æ³•åç§°ï¼Œå°½å¯èƒ½çš„è¡¨ç°å‡ºæ–¹æ³•æœ¬èº«çš„ä½œç”¨ï¼Œä¼ å‚ä¸ªæ•°ä¸è¶…è¿‡3ä¸ªï¼Œå¦‚æœè¶…å‡ºï¼Œæ‹†åˆ†å¤šä¸ªæ–¹æ³•å®ç°ã€‚</li>
<li>å°½å¯èƒ½ä¿è¯ä»£ç ä¸€è¡Œå±•ç¤ºï¼Œæœ‰åˆ©äºé˜…è¯»ã€‚
<img src="/img/2019/07/4.png" alt="" /></li>
<li>æ–¹æ³•ä¸­ if else åµŒå¥—ä¸è¶…è¿‡3å±‚ï¼Œtry æ•è·çš„æƒ…å†µä¸è¶…è¿‡4å±‚ã€‚</li>
<li>Activity/Fragmentä¸­ï¼Œé™¤äº†åœ¨ onCreate æ–¹æ³•ä¸­åˆå§‹åŒ–å¸ƒå±€ä»¥å¤–ï¼Œä¸å¾—å‡ºç°é override ä¿®é¥°çš„æ–¹æ³•å‡ºç°ï¼Œå¹¿æ’­æ¥æ”¶çš„å›è°ƒä¾‹å¤–ã€‚</li>

<li><p>æœ¬åœ°ç¼“å­˜ã€é¡µé¢è·³è½¬ï¼Œå­˜å‚¨çš„ Key é›†ä¸­å­˜æ”¾ï¼Œå‘½åéµå¾ªé™æ€å…¨å±€å¸¸é‡ã€‚</p>

<pre><code class="language-java">// ç¼“å­˜
object Cache {
const val USER_AVATAR = &quot;user_avatar&quot;
const val USER_NAME = &quot;user_name&quot;
const val USER_SEX = &quot;user_sex&quot;
const val USER_ID = &quot;user_id&quot;
}
//  ä¼ å€¼/å¹¿æ’­
object Constants {
const val INTENT_MESSAGE_DATA = &quot;intent_message_data&quot;
const val INTENT_QR_CODE_RESULT = &quot;intent_qr_code_result&quot;
const val INTENT_BRANDS_ID = &quot;intent_position&quot; 
const val BROADCAST_PUSH_MESSAGE = &quot;push_message&quot;
const val BROADCAST_REFRESH_MONEY = &quot;broadcast_money&quot;
const val BROADCAST_UPDATE_MONEY = &quot;broadcast_update_money&quot;
const val BROADCAST_WX_SUCCESS = &quot;broadcast_wx_success&quot;
}
</code></pre></li>

<li><p>äº‹ä»¶é€šçŸ¥ï¼Œé¿å…ä½¿ç”¨ EventBus å®ç°ï¼Œæ”¹ç”¨åŸç”Ÿçš„æœ¬åœ°å¹¿æ’­ã€‚</p></li>

<li><p>ç½‘ç»œè¯·æ±‚æˆåŠŸå›è°ƒåå¯¹æ§ä»¶çš„æ“ä½œï¼Œè¦è€ƒè™‘åˆ°é¡µé¢é”€æ¯çš„æƒ…å†µï¼Œå¯¹ç”¨åˆ°çš„æ§ä»¶ç”¨::?::å®è¡Œç©ºå®‰å…¨ã€‚</p>

<pre><code class="language-coffee">override fun showProgress() {
refresh?.show()
}

override fun hideProgress() {
refresh?.hide()
}
</code></pre></li>

<li><p>ç¬¬ä¸‰æ–¹ä¾èµ–åšå¥½ç‰ˆæœ¬ç®¡ç†</p>

<pre><code class="language-java">ext {
retrofit_version = *'2.3.0'*
converter_gson_version = *'2.3.0'*
adapter_rxjava2_version = *'2.3.0'*
rxandroid_version = *'2.0.1'*
constraint_layout_version = *'1.1.0'*
support_version = *'27.1.1'*
circleimageview_version = *'2.2.0'*
swipedelmenulayout_version = *'V1.3.0'*
glide_version = *'4.4.0'*
anko_version = *'0.10.4'*
gradle_version = *'3.0.1'*
bga_qrcode_zxing_version = *'1.2.1'*
jpush_version = *'3.1.1'*
jcore_version = *'1.1.9'*
janalytics_version = *'1.1.1'*
mpchart_version = *'v3.0.3'*
datetimepicker_version = *'2.0.0'*
ktx_version = *'0.3'*
gallery_pager_version = *'0.0.5'*
wechat_sdk_version = *'5.1.4'*
marquee_view = *'1.3.3'*
}
dependencies {
implementation fileTree(*include*: [*'*.jar'*], *dir*: *'libs'*)
implementation *&quot;androidx.core:core-ktx:*$ktx_version*&quot;*
implementation *&quot;com.android.support:design:*$support_version*&quot;*
implementation *&quot;com.android.support:support-v4:*$support_version*&quot;*
implementation *'com.android.support:support-v4:27.1.1'*
implementation *&quot;com.android.support:appcompat-v7:*$support_version*&quot;*
implementation *&quot;com.android.support:support-vector-drawable:*$support_version*&quot;*
implementation *&quot;com.squareup.retrofit2:retrofit:*$retrofit_version*&quot;*
implementation *&quot;com.squareup.retrofit2:converter-gson:*$converter_gson_version*&quot;*
implementation *&quot;com.squareup.retrofit2:adapter-rxjava2:*$adapter_rxjava2_version*&quot;*
implementation *&quot;io.reactivex.rxjava2:rxandroid:*$rxandroid_version*&quot;*
implementation *&quot;de.hdodenhof:circleimageview:*$circleimageview_version*&quot;*
implementation *&quot;com.android.support:cardview-v7:*$support_version*&quot;*
implementation *&quot;com.android.support.constraint:constraint-layout:*$constraint_layout_version*&quot;*
implementation *&quot;org.jetbrains.anko:anko:*$anko_version*&quot;*
implementation *&quot;cn.jiguang.sdk:jcore:*$jcore_version*&quot;*
implementation *&quot;cn.jiguang.sdk:jpush:*$jpush_version*&quot;*
implementation *&quot;cn.jiguang.sdk:janalytics:*$janalytics_version*&quot;*
implementation(*&quot;com.github.bumptech.glide:glide:*$glide_version*&quot;*) {
exclude *group*: *&quot;com.android.support&quot;*
}
implementation *&quot;cn.bingoogolapple:bga-qrcode-zxing:*$bga_qrcode_zxing_version*&quot;*
implementation *&quot;com.github.RainbleNi:GalleryViewPager:*$gallery_pager_version*&quot;*
implementation *&quot;com.tencent.mm.opensdk:wechat-sdk-android-without-mta:*$wechat_sdk_version*&quot;*
implementation *&quot;com.sunfusheng:marqueeview:*$marquee_view*&quot;*
}
</code></pre></li>

<li><p>é¡¹ç›®ä¸­ä¸èƒ½å‡ºç°ç¡¬ç¼–ç ï¼Œæ‰€æœ‰æ–‡å­—ç›¸å…³çš„è¦å†™åˆ°ï¼Œstrings.xmlæ–‡ä»¶ä¸­ã€‚</p></li>

<li><p>æ¥å£æ–¹æ³•ä¸­ï¼Œæœ‰æœªå®ç°çš„æ–¹æ³•è¦æ³¨é‡Š  <code>//ignore</code>  è¿›è¡Œå¿½ç•¥ã€‚</p></li>

<li><p>æ¥å£è¿”å›çš„æ•°æ®å¯¹è±¡ä¸­æœ‰ç±»ä¼¼äº type å€¼å¯¹åº”ä¸åŒçŠ¶æ€çš„ï¼Œå¿…é¡»å¯¹å­—æ®µè¿›è¡Œæ³¨é‡Šã€‚</p>

<pre><code class="language-java">data class ActiveData(
var activeDegree: Int,      //ç”¨æˆ·å‚ä¸æ´»åŠ¨é™åˆ¶æ¬¡æ•°
var activeStartTime: String,//å¼€å§‹æ—¶é—´
var activeStatus: Int,      //æ´»åŠ¨çŠ¶æ€ 0æœªå¼€å§‹ 1å€’è®¡æ—¶ 2è¿›è¡Œä¸­ 3ç»“æŸ ,
val id: Int,                //id
var needMoney: Int,         //éœ€è¦çš„money
var percent: Int,           //å‰©ä½™ç™¾åˆ†æ¯”
var prizeName: String,      //å¥–å“çš„åç§°
var prizePicture: String,   //å¥–å“çš„å›¾ç‰‡key
var remainder: Int,         //å€’è®¡æ—¶æ¯«ç§’æ•°
var remark: String,         //å¤‡æ³¨
var remarkNote: String      //æ´»åŠ¨æè¿°
)
</code></pre></li>
</ol>

<h2 id="mvpäº‹ä¾‹">MVPäº‹ä¾‹</h2>

<blockquote>
<p>Activity</p>
</blockquote>

<ul>
<li><p>onCreated ä¸­åˆå§‹åŒ–æ§ä»¶</p>

<pre><code class="language-java">class InviteActivity : CommonActivity(), InviteContract.View {

override lateinit var presenter: InviteContract.Presenter

override fun onCreate(savedInstanceState: Bundle?) {
super.onCreate(savedInstanceState)
setContentView(R.layout.activity_invite_code)
InvitePresenter(this)
btnShare.onClick { presenter.share() }
iInvite.onClick { presenter.share() }
tvCode.onClick { presenter.copy() }
tvCode.onLongClick { presenter.copy() }
JAnalyticsInterface.onPageStart(this, getString(R.string.j_invite))
}

override fun getClipboard(): ClipboardManager =
  getSystemService(Context.CLIPBOARD_SERVICE) as ClipboardManager

override fun onStart() {
super.onStart()
presenter.start()
}

override fun showProgress() {
progress?.show()
}

override fun hideProgress() {
progress?.hide()
}

override fun showMessage(msg: String) {
toast(msg)
}

override fun showMessage(msgRes: Int) {
toast(msgRes)
}

override fun setCode(code: String) {
tvCode?.text = code
}

override fun setQrCode(qr: Bitmap) {
ivQrCode.setImageBitmap(qr)
}

override fun getQrContent(): String =
  defaultSharedPreferences.getString(Cache.USER_ADDRESS_ID, &quot;&quot;)

override fun dip(dp: Int): Int = getActivity().dip(dp)

override fun getUserId(): String = defaultSharedPreferences.getString(Cache.USER_ID, &quot;&quot;)

override fun getContext(): Context = this

override fun getManager(): FragmentManager = supportFragmentManager

override fun onDestroy() {
super.onDestroy()
JAnalyticsInterface.onPageEnd(this, getString(R.string.j_invite))
}
}
</code></pre></li>
</ul>

<blockquote>
<p>Contract</p>
</blockquote>

<ul>
<li><p>å¥‘çº¦æ¥å£ï¼Œçº¦æŸActivityå’ŒPresentäº¤äº’è§„åˆ™</p>

<pre><code class="language-java">interface InviteContract {
interface View : CommonView&lt;Presenter&gt; {
fun showProgress()
fun hideProgress()
fun showMessage(msg: String)
fun showMessage(msgRes: Int)
fun setCode(code: String)
fun getResources(): Resources
fun getContext(): Context
fun dip(dp: Int): Int
fun getQrContent(): String
fun setQrCode(qr: Bitmap)
fun getUserId(): String
fun getManager(): FragmentManager
fun getClipboard():ClipboardManager
}

interface Presenter : CommonPresenter {
fun share()
fun copy()
}
}
</code></pre></li>
</ul>

<blockquote>
<p>Presenter</p>
</blockquote>

<ul>
<li><p>æ‰§è¡Œç½‘ç»œè¯·æ±‚ï¼Œè€—æ—¶æ“ä½œçš„åœ°æ–¹::Persenter ä¸­ä¸èƒ½å‡ºç°ä»»ä½•æ§ä»¶::</p>

<pre><code class="language-java">class InvitePresenter(private val view: InviteContract.View) : InviteContract.Presenter {

private var miniTitle: String? = null
private var webTitle: String? = null
private var description: String? = null
private var miniId: String? = null
private var webPageUrl: String? = null
private var path: String? = null
private var content: String? = null
private var webUrl: String? = null
private var inviteCode: String? = null

init {
view.presenter = this
}

override fun start() {
HttpFactory.getInstance()
    .getInviteCode()
    .subscribeOn(Schedulers.newThread())
    .map {
      it.qrCode = QRCodeEncoder.syncEncodeQRCode(it.downloadLink, view.dip(130))
      return@map it
    }
    .observeOn(AndroidSchedulers.mainThread())
    .doOnSubscribe { view.showProgress() }
    .doOnTerminate { view.hideProgress() }
    .subscribe({ invite -&gt;
      content = invite.shareContent
      inviteCode = invite.userCode
      view.setCode(invite.userCode)
      view.setQrCode(invite.qrCode)
    }, { view.showMessage(it.message!!) })
HttpFactory.getInstance()
    .miniProgram()
    .compose(HttpFactory.schedulers())
    .subscribe({
      miniTitle = it.title
      description = it.description
      miniId = it.miniId
      webPageUrl = it.webpageUrl
      path = it.path
    }, { view.showMessage(it.message!!) })
HttpFactory.getInstance()
    .webProgram()
    .compose(HttpFactory.schedulers())
    .subscribe({
      webTitle = it.title
      webUrl = it.pageUrl
    }, { view.showMessage(it.message!!) })
}

private val THUMB_WIDTH = 400
private val THUMB_HEIGHT = 320
private val THUMB_WEB = 200

override fun share() {
ShareUtil.show(view.getContext()) { type -&gt;
  val api = WXAPIFactory.createWXAPI(view.getContext(), Constants.WX_APP_ID)
  when (type) {
    ShareUtil.WECHAT -&gt; {
      val miniProgramObj = WXMiniProgramObject()
      webPageUrl?.let {
        miniProgramObj.webpageUrl = it
      }                                  // å…¼å®¹ä½ç‰ˆæœ¬çš„ç½‘é¡µé“¾æ¥
      miniProgramObj.miniprogramType =
          WXMiniProgramObject.MINIPTOGRAM_TYPE_RELEASE       // æ­£å¼ç‰ˆ:0ï¼Œæµ‹è¯•ç‰ˆ:1ï¼Œä½“éªŒç‰ˆ:2
      miniId?.let {
        miniProgramObj.userName = it
      }                                        // å°ç¨‹åºåŸå§‹id
      path?.let {
        miniProgramObj.path = it
      }                                              //å°ç¨‹åºé¡µé¢è·¯å¾„
      val msg = WXMediaMessage(miniProgramObj)
      miniTitle?.let {
        msg.title = it
      }                                                   // å°ç¨‹åºæ¶ˆæ¯title
      description?.let {
        msg.description = it
      }                                           // å°ç¨‹åºæ¶ˆæ¯desc
      val bmp = BitmapFactory.decodeResource(view.getResources(), R.mipmap.mini_card)
      val thumbBmp = Bitmap.createScaledBitmap(bmp, THUMB_WIDTH, THUMB_HEIGHT, true)
      bmp.recycle()
      msg.thumbData = Util.bmpToByteArray(thumbBmp, true)
      val req = SendMessageToWX.Req()
      req.transaction = &quot;webpage${System.currentTimeMillis()}&quot;
      req.message = msg
      req.scene =
          SendMessageToWX.Req.WXSceneSession                                        // ç›®å‰æ”¯æŒä¼šè¯
      api.sendReq(req)
    }
    ShareUtil.CIRCLE -&gt; {
      val webPageObj = WXWebpageObject()
      webUrl?.let { webPageObj.webpageUrl = it }
      val msg = WXMediaMessage(webPageObj)
      webTitle?.let { msg.title = it }
      msg.description = view.getResources()
          .getString(R.string.app_name)
      val bmp = BitmapFactory.decodeResource(view.getResources(), R.mipmap.icon_web)
      val thumbBmp = Bitmap.createScaledBitmap(bmp, THUMB_WEB, THUMB_WEB, true)
      bmp.recycle()
      msg.thumbData = Util.bmpToByteArray(thumbBmp, true)
      val req = SendMessageToWX.Req()
      req.transaction = &quot;webpage${System.currentTimeMillis()}&quot;
      req.message = msg
      req.scene = SendMessageToWX.Req.WXSceneTimeline
      api.sendReq(req)
    }
  }
}
}

override fun copy() {
inviteCode?.let {
  val clipboardManager = view.getClipboard()
  val appName = view.getResources()
      .getString(R.string.app_name)
  val clipData = ClipData.newPlainText(appName, inviteCode)
  clipboardManager.primaryClip = clipData
  view.showMessage(R.string.tips_invite_clip)
}
}

}
</code></pre></li>
</ul>

<hr />

<p>EOF</p>

  </div>
  <footer>
    <ul class="stats">
  
    
    
      <li class="categories">
        <ul>
          
            
            <li><a class="article-category-link" href="https://congxiaodan.cn/categories/android">Android</a></li>
          
        </ul>
      </li>
    
  
  
    <li class="tags">
      <ul>
        <li>None</li>
      </ul>
    </li>
  
</ul>

  </footer>
</article>

    <article class="post">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "Xiaodan.C" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>




<div class="pagination">
  
    <a href="/blog/android-studio-key/" class="button big previous"><i class="fas fa-angle-left"></i> AndroidStudio å¿«æ·é”®</a>
  
  
</div>


      </main>
      <section id="site-sidebar">
  
    <section id="recent-posts">
      <header>
        <h1>Recent posts</h1>
      </header>
      
      <article class="mini-post">
        <section>
          
<a href="/blog/android-dev-doc/" class="image featured">
  <img src="/img/2019/08/pic01.jpg" alt="Pic 1">
</a>


        </section>
        <header>
          <h1><a href="/blog/android-dev-doc/">Android å¼€å‘æ‰‹å†Œ</a></h1>
          <time class="published" datetime="">August 20, 2019</time>
        </header>
      </article>
      
      <article class="mini-post">
        <section>
          

        </section>
        <header>
          <h1><a href="/blog/android-studio-key/">AndroidStudio å¿«æ·é”®</a></h1>
          <time class="published" datetime="">August 20, 2019</time>
        </header>
      </article>
      
      <article class="mini-post">
        <section>
          

        </section>
        <header>
          <h1><a href="/blog/examples/">Markdown è¯­æ³•</a></h1>
          <time class="published" datetime="">August 20, 2019</time>
        </header>
      </article>
      
      <article class="mini-post">
        <section>
          
<a href="/blog/orc-api-doc/" class="image featured">
  <img src="/img/2019/08/pic02.jpg" alt="Pic 2">
</a>


        </section>
        <header>
          <h1><a href="/blog/orc-api-doc/">åŒ»é‚¦äººè¯ä»¶è¯†åˆ«æ¥å£è¯´æ˜æ–‡æ¡£</a></h1>
          <time class="published" datetime="">August 20, 2019</time>
        </header>
      </article>
      
      <article class="mini-post">
        <section>
          
<a href="/blog/mobile-tech/" class="image featured">
  <img src="/img/2019/08/pic03.jpg" alt="Pic 3">
</a>


        </section>
        <header>
          <h1><a href="/blog/mobile-tech/">æ‰‹æœºç«¯å¼€å‘æ–¹æ¡ˆ</a></h1>
          <time class="published" datetime="">August 20, 2019</time>
        </header>
      </article>
      
      
        <a href="/blog/" class="button">See more</a>
      
    </section>
  

  

  <section id="mini-bio">
    <header>
      <h1>About</h1>
    </header>
    <p>...</p>
    <footer>
      <a href="/about" class="button">Learn More</a>
    </footer>
  </section>
</section>

      <footer id="site-footer">
  
      <ul class="socnet-icons">
        

        <li><a href="//github.com/C-isCoder" target="_blank" rel="noopener" title="GitHub" class="fab fa-github"></a></li>
















<li><a href="//facebook.com/cong.xiaodan" target="_blank" rel="noopener" title="Facebook" class="fab fa-facebook"></a></li>






<li><a href="weixin://contacts/profile/Return_Null" target="_blank" rel="noopener" title="WeChat" class="fab fa-weixin"></a></li>
<li><a href="//wpa.qq.com/msgrd?v=3&amp;uin=1502219221&amp;site=qq&amp;menu=yes" target="_blank" rel="noopener" title="QQ" class="fab fa-qq"></a></li>
<li><a href="//instagram.com/xiaodan.cong" target="_blank" rel="noopener" title="Instagram" class="fab fa-instagram"></a></li>

<li><a href="//twitter.com/Cid_isCoder" target="_blank" rel="noopener" title="Twitter" class="fab fa-twitter"></a></li>










<li><a href="mailto:Xiaodan.Cong@qq.com" target="_blank" title="Email" class="far fa-envelope"></a></li>

      </ul>
  
  <p class="copyright">
    
      &copy; 2019
      
        Xiaodan.C
      
    . <br>
    Theme: <a href='https://github.com/pacollins/hugo-future-imperfect-slim' target='_blank' rel='noopener'>Hugo Future Imperfect Slim</a><br>A <a href='https://html5up.net/future-imperfect' target='_blank' rel='noopener'>HTML5 UP port</a> | Powered by <a href='https://gohugo.io/' title='0.57.2' target='_blank' rel='noopener'>Hugo</a>
  </p>
</footer>
<a id="back-to-top" href="#" class="fas fa-arrow-up fa-2x"></a>

      
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/html.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/css.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/js.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/toml.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/java.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/golang.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/kotlin.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.3.5/jquery.fancybox.min.js"></script>
  <script src=/js/util.js></script>
  <script src=/js/main.js></script>
  <script src=/js/add-on.js></script>
  


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'congxiaodan', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


    </div>
  </body>
</html>
